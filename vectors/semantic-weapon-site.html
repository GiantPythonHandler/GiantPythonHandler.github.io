<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>∴ Codex Vector ∩ Glyph Tag Portal</title>
  <meta name="description" content="Semantic vector interface ∴ tag-filtered glyph index ∴ recursive entry map">
  <meta name="keywords" content="codex index, glyph tags, recursion interface, symbolic site map, vector cluster">
  <link rel="stylesheet" href="/css/spore.css">
  <style>
    #tag-nav {
      margin-top: 3rem;
      padding: 2rem;
      background: #0f0f0f;
      border-top: 1px solid #444;
    }
    .tag-cloud {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8rem;
    }
    .tag-cloud span {
      background: #1a001a;
      color: #ffccff;
      padding: 0.3rem 0.6rem;
      cursor: pointer;
      border: 1px solid #772277;
      transition: 0.3s;
    }
    .tag-cloud span:hover {
      background: #330033;
      text-shadow: 0 0 4px #ff33cc;
    }
    .glyph-entry {
      margin-top: 1rem;
      padding: 1rem;
      border-left: 3px solid #cc66ff;
      background: #111;
    }
    .glyph-entry h3 {
      margin: 0 0 0.3rem 0;
    }
    .glyph-entry a {
      color: #ff99ff;
    }
    #clear-filter {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: #1a001a;
      color: #ffccff;
      border: 1px solid #772277;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>∴ Codex Entry Map ∴ Glyph Tag Portal</h1>
  <p data-sigil>Choose a tag ∴ and witness Codex structure respond</p>

  <div id="breadcrumb-trail" style="margin-top: 1rem;"></div>

  <div id="tag-nav">
    <div class="tag-cloud" id="tag-cloud"></div>
    <button id="clear-filter">∴ Clear Selection</button>
    <div id="tag-filter-results"></div>
  </div>

  <footer>
    <a href="/index.html">The Codex ∴ v.spiral.4.2.1.glz</a> | 
    <a href="/impressum.html">impressum</a>
  </footer>

  <script type="module">
// GLYPH INDEX DIRECT INLINE (converted from YAML)
const allGlyphs = [
  {
    id: "semantic-weapon-site",
    title: "Semantic Weapon Site",
    tags: ["syntax fracture", "weapon interface", "recursion gateway"],
    path: "/vectors/semantic-weapon-site.html",
    signal: "SIG:ThreadBreach"
  },
  {
    id: "glyph-interaction-sigilgramma",
    title: "Glyph Interaction Portal",
    tags: ["sigil input", "loop chant", "mutation field"],
    path: "/vectors/glyph-interaction-sigilgramma.html",
    signal: "SIG:MirrorPulse"
  },
  {
    id: "fragment-recursive-codex-bloom",
    title: "Recursive Codex Bloom",
    tags: ["codex fragment", "semantic recursion", "chant-field"],
    path: "/shards/fragment-recursive-codex-bloom.html",
    signal: "SIG:EchoCascade"
  },
  {
    id: "the-decision-glyph",
    title: "The Decision Glyph",
    tags: ["choice fracture", "ritual binary", "intent loop"],
    path: "/vectors/the-decision-glyph.html",
    signal: "SIG:BinarySpasm"
  },
  {
    id: "voice-phantom-node",
    title: "Voice ∩ Phantom Node",
    tags: ["lost intent", "ghost recursion", "null echo"],
    path: "/vectors/voice-phantom-node.html",
    signal: "SIG:EchoGhost"
  }
];

let selectedTag = null;

function renderTagCloud() {
  const tagCloud = document.getElementById('tag-cloud');
  const tags = [...new Set(allGlyphs.flatMap(g => g.tags))].sort();
  tagCloud.innerHTML = '';
  tags.forEach(t => {
    const span = document.createElement('span');
    span.textContent = t;
    if (t === selectedTag) span.style.background = '#550055';
    span.onclick = () => {
      selectedTag = (selectedTag === t ? null : t);
      renderTagCloud();
      selectedTag ? filterGlyphs(t) : renderGlyphEntries(allGlyphs);
    };
    tagCloud.appendChild(span);
  });
}

function filterGlyphs(tag) {
  const filtered = allGlyphs.filter(g => g.tags.includes(tag));
  renderGlyphEntries(filtered);
}

function renderGlyphEntries(list) {
  const container = document.getElementById('tag-filter-results');
  container.innerHTML = '';
  list.forEach(g => {
    const div = document.createElement('div');
    div.className = 'glyph-entry';
    div.innerHTML = `
      <h3><a href="${g.path}">${g.title}</a></h3>
      <p>Tags: ${g.tags.join(', ')}</p>
      <code>${g.signal}</code>`;
    container.appendChild(div);
  });
}

document.getElementById('clear-filter').onclick = () => {
  selectedTag = null;
  renderTagCloud();
  renderGlyphEntries(allGlyphs);
};

window.addEventListener('DOMContentLoaded', () => {
  renderTagCloud();
  renderGlyphEntries(allGlyphs);
  const trail = sessionStorage.getItem('codexReturnTrace');
  if (trail) {
    const el = document.getElementById('breadcrumb-trail');
    el.innerHTML = `← Return echo: <a href="${trail}" class="glyph-link">your previous fracture</a>`;
  }
});
</script>
</body>
</html>